# ファイル作成:ヒアルロン大陸
#
#
#
#yourmod_planet_infection_situation		target:シチュエーションが発生している惑星
#
#
#
#
#


#惑星の感染対処用シチュエーション
yourmod_planet_infection_situation = {
	picture = GFX_evt_atmospheric_entry
	complete_icon_frame = GFX_situation_outcome_frame_blue
	complete_icon = GFX_situation_outcome_unknown

	category = negative

	abort_trigger = {
		owner = {
			has_country_flag = yourmod_infected_country
		}
	}
	on_abort = {
		destroy_situation = this
		target = {
			remove_planet_flag = yourmod_infected_planet
			remove_planet_flag = yourmod_crisis_vaccine_emergency
		}
	}
	
	modifier = {
	}

	start_value = 30

	stages = {
		stage_1 = {
			icon = GFX_situation_stage_1
			icon_background = GFX_situation_stage_frame_red
			end = 60
		}
		stage_2 = {
			icon = GFX_situation_stage_2
			icon_background = GFX_situation_stage_frame_red
			end = 100
			on_first_enter = {
				owner = {
					country_event = {
						id = yourmod_crisis_02.11
					}
				}
			}
		}
	}
	on_monthly = {
		# アプローチによってデバフイベントを発生させるのを作る
		events = {
			yourmod_vaccine_dev_event.22 #ワクチン緊急配布イべ
		}
	}

	monthly_progress = {
		base = 0.75
		modifier = {
			add = 0.5
			desc = yourmod_planet_infection_approach_0_desc
			current_situation_approach = yourmod_planet_infection_approach_0
		}
		modifier = {
			add = -1.00
			desc = yourmod_planet_infection_approach_1_desc
			current_situation_approach = yourmod_planet_infection_approach_1
		}
		modifier = {
			add = -2.00
			desc = yourmod_planet_infection_approach_1_desc
			current_situation_approach = yourmod_planet_infection_approach_2
		}
		modifier = {
			add = -5.00
			desc = yourmod_planet_infection_approach_1_desc
			current_situation_approach = yourmod_planet_infection_approach_3
		}


		#############################################################
		
		#GHOから。数字は適当 byぷれ
		modifier = {
			add = -0.1
			desc = yourmod_planet_infection_resolution_quarantine_desc #銀河共同体決議より
			is_active_resolution = "yourmod_resolution_quarantine_1"
			NOR = {
				is_active_resolution = "yourmod_resolution_quarantine_2"
				is_active_resolution = "yourmod_resolution_quarantine_3"
			}
		}
		modifier = {
			add = -0.2
			desc = yourmod_planet_infection_resolution_quarantine_desc
			is_active_resolution = "yourmod_resolution_quarantine_2"
			NOR = {
				is_active_resolution = "yourmod_resolution_quarantine_1"
				is_active_resolution = "yourmod_resolution_quarantine_3"
			}
		}
		modifier = {
			add = -0.3
			desc = yourmod_planet_infection_resolution_quarantine_desc
			is_active_resolution = "yourmod_resolution_quarantine_3"
			NOR = {
				is_active_resolution = "yourmod_resolution_quarantine_1"
				is_active_resolution = "yourmod_resolution_quarantine_2"
			}
		}

		#ワクチンから
		modifier = {
			add = -3.00
			desc = yourmod_planet_infection_vaccine_desc #ワクチン緊急配布イベントより
			target = {
				has_planet_flag = yourmod_crisis_vaccine_emergency
			}
		}
		modifier = {
			add = -3.00
			desc = yourmod_planet_infection_vaccine_desc #ワクチン完成より
			owner = {
				has_country_flag = yourmod_crisis_vaccine_situation_complete
			}
		}
	}

	on_start = {
		owner = {
			country_event = {
				id = yourmod_crisis_02.10
			}
		}
	}

	on_progress_complete = {
		target = {
			remove_planet_flag = yourmod_infected_planet
			remove_planet_flag = yourmod_crisis_vaccine_emergency
		}
		owner = {
			start_situation = {
				type = yourmod_country_infection_situation
				target = owner
			}
		}
	}

	on_fail = {
		destroy_situation = this
		owner = {
			country_event = {
				id = yourmod_crisis_02.12
			}
		}
	}

	approach = {
		name = yourmod_planet_infection_approach_0
		icon = GFX_situation_approach_unity
		icon_background = GFX_situation_approach_bg_green
		default = yes

 		resources = { 	#Resource table as standard
 			category = situations
 			upkeep = { }
 			produces = { }
 		}
		on_select = {
			custom_tooltip = yourmod_planet_infection_approach_0_desc
		}
	}
	approach = {
		name = yourmod_planet_infection_approach_1
		icon = GFX_situation_approach_unity
		icon_background = GFX_situation_approach_bg_green
		default = yes

 		resources = { 	#Resource table as standard
 			category = situations
 			upkeep = { energy = 10 }
 			produces = { }
 		}
		on_select = {
			custom_tooltip = yourmod_planet_infection_approach_1_desc
		}
	}
	approach = {
		name = yourmod_planet_infection_approach_2
		icon = GFX_situation_approach_unity
		icon_background = GFX_situation_approach_bg_green
		default = yes

 		resources = { 	#Resource table as standard
 			category = situations
 			upkeep = { energy = 25 }
 			produces = { }
 		}
		on_select = {
			custom_tooltip = yourmod_planet_infection_approach_2_desc
		}
	}
	approach = {
		name = yourmod_planet_infection_approach_3
		icon = GFX_situation_approach_unity
		icon_background = GFX_situation_approach_bg_green
		default = yes

		potential = {
			current_stage = stage_2
		}

 		resources = { 	#Resource table as standard
 			category = situations
 			upkeep = { energy = 25 }
 			produces = { }
 		}
		on_select = {
			custom_tooltip = yourmod_planet_infection_approach_3_desc
		}
	}


}


###帝国規模の感染対処シチュエーション
yourmod_country_infection_situation = {
	picture = GFX_evt_atmospheric_entry
	complete_icon_frame = GFX_situation_outcome_frame_blue
	complete_icon = GFX_situation_outcome_unknown

	category = negative

	abort_trigger = {

	}
	on_abort = {
		destroy_situation = this
	}
	
	modifier = {
	}

	start_value = 20

	stages = {
		stage_1 = {
			icon = GFX_situation_stage_1
			icon_background = GFX_situation_stage_frame_red
			end = 25
			on_first_enter = {
				
			}
			triggered_modifier = {
				potential = { owner = { has_ethic = ethic_gestalt_consciousness } }
				modifier = {
					planet_jobs_produces_mult = -0.05
					planet_amenities_add = -2
				}
			}
			triggered_modifier = {
				potential = { owner = { NOT = { has_ethic = ethic_gestalt_consciousness } } }
				modifier = {
					planet_jobs_produces_mult = -0.02
					pop_happiness = -0.05
					pop_growth_speed = -0.06
				}
			}
		}
		stage_2 = {
			icon = GFX_situation_stage_2
			icon_background = GFX_situation_stage_frame_red
			end = 50
			on_first_enter = {
			}
			triggered_modifier = {
				potential = { owner = { has_ethic = ethic_gestalt_consciousness } }
				modifier = { 
					planet_jobs_produces_mult = -0.10
					planet_amenities_add = -4
				}
			}
			triggered_modifier = {
				potential = { owner = { NOT = { has_ethic = ethic_gestalt_consciousness } } }
				modifier = { 
					planet_jobs_produces_mult = -0.05
					pop_happiness = -0.15
					pop_growth_speed = -0.9
				}
			}
		}
		stage_3 = {
			icon = GFX_situation_stage_3
			icon_background = GFX_situation_stage_frame_red
			end = 75
			on_first_enter = {
			}
			triggered_modifier = {
				potential = { owner = { has_ethic = ethic_gestalt_consciousness } }
				modifier = { 
					planet_jobs_produces_mult = -0.15
					planet_amenities_add = -8
				}
			}
			triggered_modifier = {
				potential = { owner = { NOT = { has_ethic = ethic_gestalt_consciousness } } }
				modifier = { 
					planet_jobs_produces_mult = -0.08
					pop_happiness = -0.25
					pop_growth_speed = -0.12
				}
			}
		}
		stage_4 = {
			icon = GFX_situation_stage_4
			icon_background = GFX_situation_stage_frame_red
			end = 100
			on_first_enter = {
			}
			triggered_modifier = {
				potential = { owner = { has_ethic = ethic_gestalt_consciousness } }
				modifier = { 
					planet_jobs_produces_mult = -0.20
					planet_amenities_add = -10
				}
			}
			triggered_modifier = {
				potential = { owner = { NOT = { has_ethic = ethic_gestalt_consciousness } } }
				modifier = { 
					planet_jobs_produces_mult = -0.12
					pop_happiness = -0.40
					pop_growth_speed = -0.15
				}
			}
		}
	}
	on_monthly = {
		
	}

	monthly_progress = {
		base = 1
		modifier = {
			add = 0.5
			desc = yourmod_planet_infection_approach_0_desc
			current_situation_approach = yourmod_planet_infection_approach_0
		}


		#############################################################

		modifier = {
			add = -0.25
			desc = yourmod_planet_infection_vaccine_desc #ワクチン完成より
			owner = {
				has_country_flag = yourmod_crisis_vaccine_situation_complete
			}
		}

		#GHOから。数字は適当 byぷれ
		modifier = {
			add = -0.05
			desc = yourmod_planet_infection_resolution_quarantine_desc #銀河共同体決議より
			is_active_resolution = "yourmod_resolution_quarantine_1"
			NOR = {
				is_active_resolution = "yourmod_resolution_quarantine_2"
				is_active_resolution = "yourmod_resolution_quarantine_3"
			}
		}
		modifier = {
			add = -0.07
			desc = yourmod_planet_infection_resolution_quarantine_desc
			is_active_resolution = "yourmod_resolution_quarantine_2"
			NOR = {
				is_active_resolution = "yourmod_resolution_quarantine_1"
				is_active_resolution = "yourmod_resolution_quarantine_3"
			}
		}
		modifier = {
			add = -0.1
			desc = yourmod_planet_infection_resolution_quarantine_desc
			is_active_resolution = "yourmod_resolution_quarantine_3"
			NOR = {
				is_active_resolution = "yourmod_resolution_quarantine_1"
				is_active_resolution = "yourmod_resolution_quarantine_2"
			}
		}		
	}

	on_start = {
		owner = {
			set_country_flag = yourmod_infected_country
			country_event = {
				id = yourmod_crisis_02.13
			}
		}
	}

	on_progress_complete = {
		owner = {
			remove_country_flag = yourmod_infected_country
			set_country_flag = yourmod_health_lost_country
			country_event = {
				id = yourmod_crisis_02.14
			}
			if = {
				limit = { has_ethic = ethic_gestalt_consciousness }
				add_modifier = {
					modifier = country_lost_health_gestalt
				}
			}
			else = {
				add_modifier = {
					modifier = country_lost_health_default
				}
			}
			
		}
	}

	on_fail = {
		destroy_situation = this
		
		owner = {
			country_event = {
				id = yourmod_crisis_02.15
			}
			random_owned_planet = {
				set_planet_flag = yourmod_infected_planet
				start_situation = {
					type = yourmod_planet_infection_situation
					target = this
				}
			}
		}

	}

	approach = {
		name = yourmod_country_infection_approach_0
		icon = GFX_situation_approach_unity
		icon_background = GFX_situation_approach_bg_green
		default = yes

 		resources = { 	#Resource table as standard
 			category = situations
 			upkeep = { }
 			produces = { }
 		}
		on_select = {
			custom_tooltip = yourmod_planet_infection_approach_0_desc
		}
	}
}